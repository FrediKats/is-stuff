Двойственность задачи линейного программирования
------------------------------------------------

  -- --
     
  -- --

Задача (2) называется двойственной по отношению к прямой (1) (и
наоборот!).

**[Пример:]{.underline}** Предприятие выпускает три вида продукции.
Каждая продукция требует обработки на трех различных типах установок.
Ресурс времени каждого типа установок ограничен. Известна прибыль от
единицы каждого вида продукции: . Если количество выпускаемой продукции
каждого вида: ; тогда прибыль определяется по формуле

при ограничениях следующего вида:

,

,

,

,

где ­-- ресурсы времени установок первого, второго и третьего типов.
Величины определяют количество ресурса времени установки -го типа,
которое необходимо для выпуска одной единицы продукции -го вида.

Двойственная к ней задача будет иметь вид:

с ограничениями:

.

Здесь - это оценка (цена), соответствующая одной единице ограниченного
ресурса, соответствующего первой установке. И она равна величине, на
которую могла бы увеличиться суммарная прибыль, если бы количество этого
ограниченного ресурса увеличилось на единицу, и если это увеличение было
бы использовано оптимально. Иными словами, -- это количество прибыли,
недополученной из-за нехватки единицы ограниченного ресурса .
Аналогичным образом можно интерпретировать смысл величин и .

**Преобразования при решении прямой и двойственной задач.** Пусть
имеются прямая и двойственная задачи следующего вида:

  ---------------------------- --------------------------------
  Прямая задача:               Представим ограничения в виде:
  Двойственная к ней задача:   
  ---------------------------- --------------------------------

Для ограничений прямой задачи симплексная таблица имеет вид:

  ----- ----- ----- ----- ----- ----- -----
              ...         ...         1
  =           ...         ...         
  ...   ...   ...   ...   ...   ...   ...
  =           ...         ...         
  ...   ...   ...   ...   ...   ...   ...
  =           ...         ...         
  =           ...         ...         0
  ----- ----- ----- ----- ----- ----- -----

Пусть - разрешающий элемент, сделаем шаг модифицированного жорданова
исключения:

  ----- ----- ----- ----- ----- ----- -----
              ...         ...         1
  =           ...         ...         
  ...   ...   ...   ...   ...   ...   ...
  =           ...   1     ...         
  ...   ...   ...   ...   ...   ...   ...
  =           ...         ...         
  =           ...         ...         
  ----- ----- ----- ----- ----- ----- -----

Где и всю данную таблицу следует разделить еще на .

Симплексную таблицу для двойственной задачи запишем, развернув ее на .
Получаем:

  ----- ----- ----- ----- ----- ----- -----
        =     ...   =     ...   =     
              ...         ...         
  ...   ...   ...   ...   ...   ...   ...
              ...         ...         
  ...   ...   ...   ...   ...   ...   ...
              ...         ...         
  1           ...         ...         0
  ----- ----- ----- ----- ----- ----- -----

Пусть - направляющий элемент. Сделаем шаг обыкновенного жорданова
исключения (отличие от модифицированного состоит в том, что элементы в
разрешающей строке меняют знаки, а в столбце знаки сохраняются; в
остальном преобразование остается тем же):

  ----- ----- ----- ----- ----- ----- -----
        =     ...   =     ...   =     
              ...         ...         
  ...   ...   ...   ...   ...   ...   ...
              ...   1     ...         
  ...   ...   ...   ...   ...   ...   ...
              ...         ...         
  1           ...         ...         
  ----- ----- ----- ----- ----- ----- -----

Где и всю данную таблицу также следует разделить еще на .

*Замечание:* Не следует забывать при преобразованиях, что в данном
случае у нас таблица развернута.

Таким образом, нетрудно заметить, что шаг модифицированного жорданова
исключения над симплексной таблицей прямой задачи соответствует шагу
обыкновенного жорданова исключения над симплексной таблицей двойственной
задачи. Эти взаимно двойственные задачи можно совместить в одной
симплексной таблице.

  ----- ----- ----- ----- ----- ----- -----
        =     ...   =     ...   =     1
  =           ...         ...         
  ...   ...   ...   ...   ...   ...   ...
  =           ...         ...         
  ...   ...   ...   ...   ...   ...   ...
  =           ...         ...         
  1 =         ...         ...         0
  ----- ----- ----- ----- ----- ----- -----

Можно показать, что, решая основную задачу линейного программи­рования,
решаем и двойственную к ней. И наоборот. Причем, .

Теоремы двойственности
----------------------

**Основная теорема двойственности линейного программирования:** Пусть
рассматривается пара двойственных задач:

  ------- -------
  \(1\)   \(2\)
  ------- -------

Если одна из этих задач обладает оптимальным решением, то и двойственная
к ней задача также имеет оптимальное решение. Причем экстремальные
значения соответствующих линейных форм равны: .

Если же у одной из этих задач линейная форма не ограничена, то
двойственная к ней задача противоречива.

*Доказательство:* Пусть основная задача (1) имеет конечное решение и
получена окончательная симплексная таблица:

  ------ ------ ------ ------ ------ ------ ------ ------ ------
                =      ....   =      =      ....   =      =
                       ....                 ....          1
         =             ....                 ....          
  ....   ....   ....   ....   ....   ....   ....   ....   ....
         =             ....                 ....          
         =             ....                 ....          
  ....   ....   ....   ....   ....   ....   ....   ....   ....
         =             ....                 ....          
  1      =             ....                 ....          
  ------ ------ ------ ------ ------ ------ ------ ------ ------

Так как данная таблица, по предположению, соответствует оптимальному
решению задачи (1), то и . При этом достигается при .

Рассмотрим полученную таблицу двойственной задачи. Полагая значения
переменных слева (небазисных) равными нулю:

,

найдем , ..., , , ..., . Следова­тельно, получено опорное решение

, ..., , , ..., .

Из последнего столбца,

в точке

будет минимальным в силу того, что , . Следовательно, .

Пусть теперь линейная форма прямой задачи неограничена, т.е. для
некоторой верхней переменной, например, , соответствующий коэффициент ,
а все коэффициенты этого столбца симплексной таблицы неположительны: , ,
..., . Тогда из таблицы для двойственной задачи:

,

то есть система ограничений двойственной задачи противоречива. Так как
из неотрицательности следует неположительность (нельзя сделать ее
положительной), то есть система несовместна.

Теорема доказана.

**Вторая теорема двойственности:** Если хотя бы одно оптимальное решение
одной из двойственных задач обращает -е ограничение этой задачи в
строгое неравенство, то -я компонента (т.е. или ) каждого оптимального
решения второй двойственной задачи равна нулю.

Если же -я компонента хотя бы одного оптимального решения одной из
двойственных задач положительна, то каждое оптимальное решение другой
двойственной задачи обращает -е ограничение в строгое равенство.

Т.е. оптимальные решения и пары двойственных задач удовлетворяют
условиям

\(1\)

\(2\)

**[Доказательство:]{.underline}**

Пусть и -- оптимальные решения пары двойственных задач. Тогда для

,

они удовлетворяют следующим ограничениям:

. (3)

Умножим (3), соответственно, на и , и просуммируем полученные выражения:

. (4)

Из основной теоремы двойственности следует

. (5)

И с учетом (4) получаем:

,

.

Первое из этих выражений можем переписать в виде

,

и так как все и выражения в скобках неотрицательны, то опуская ∑,
получим:

.

Аналогично получим:

.

Что и требовалось доказать.

Справедлива и обратная теорема.

Метод последовательного уточнения оценок
========================================

Иногда называют еще двойственным симплекс-методом. Ранее говорилось, что
одновременно с решением прямой задачи, решается и двойственная задача.
Если проследить за получающимися преобразованиями двойственной таблицы и
переменных и , записав таблицу для двойственной задачи в обычном виде,
то получим описание нового метода: метода последовательного уточнения
оценок.

Пусть дана задача:

Симплексная таблица, построенная для данной задачи, будет иметь вид:

  ------ ------ ------ ------ ------ ------ ------
                ....          ....          1
  =             ....          ....          
  ....   ....   ....   ....   ....   ....   ....
  =             ....          ....          
  ....   ....   ....   ....   ....   ....   ....
  =             ....          ....          
  =             ....          ....          0
  ------ ------ ------ ------ ------ ------ ------

В методе последовательного уточнения оценок сначала избавляются от
отрицательности в -строке (получают псевдоплан), а затем, перебирая
псевдопланы, ищут оптимальный план (первый найденный опорный).

**Правило выбора разрешающего элемента** для избавления от
отрица­тельности в -строке.

1)  Если все коэффициенты -строки неотрицательны, то 0 является оценкой
    снизу для целевой функции и можно переходить к отысканию
    оптимального решения. Иначе выбираем некоторый и рассматриваем -й
    столбец.

2)  Находим в -м столбце какой-нибудь из отрицательных элементов,
    например, . Тогда строку с номером , содержащую , выбираем в
    качестве разрешающей строки. Если все коэффициенты -го столбца
    неотрицательны, то либо *неограничена снизу* (), либо *система
    ограничений противоречива*. (Из противоречивости двойственной не
    следует неограниченность прямой задачи).

3)  Находим неотрицательное отношение коэффициента -строки к
    коэффициентам разрешающей (-й) строки. В качестве разрешающего берем
    тот элемент разрешающей -й строки, для которого это отношение
    положительно и минимально, т.е. выбираем некоторый коэффициент , для
    которого .

Выбрав разрешающий элемент, делаем шаг обыкновенного жорданова
исключения. Указанная последовательность действий выполняется до тех
пор, пока все коэффициенты -строки не станут неотрицательными. Например,
будет получена следующая таблица

  ------ ------ ------ ------ ------ ------ ------ ------
                ....                 ....          1
  =             ....                 ....          
  ....   ....   ....   ....   ....   ....   ....   ....
  =             ....                 ....          
  =             ....                 ....          
  ....   ....   ....   ....   ....   ....   ....   ....
  =             ....                 ....          
  =             ....                 ....          
  ------ ------ ------ ------ ------ ------ ------ ------

Если все - неотрицательны, то таблица соответствует оптималь­ному
решению и , иначе, - оценка снизу для .

**Правило выбора разрешающего элемента при поиске оптимального
решения.**

1)  В качестве разрешающей строки берем строку, содержащую отрицательный
    коэффициент, например, , и строка с номером будет разрешающей.

2)  В качестве разрешающего выбираем тот положительный коэффициент
    строки , для которого

.

Если в строке с номером нет положительных коэффициентов, то *ограничения
задачи противоречивы*.

После выбора разрешающего элемента делаем шаг обыкновенного жорданова
исключения.

После конечного числа шагов либо найдем оптимальное решение, либо можно
убедимся в противоречивости ограничений задачи.

**[Замечание:]{.underline}** Если в симплекс-методе мы приближаемся к
оптимальному решению при поиске минимума *сверху*, передвигаясь по
опорным планам, то в методе последовательного уточнения оценок при
поиске минимума к оптимальному решению *снизу*, причем промежуточные
планы (*псевдопланы*) не являются опорными (лежат вне многогранника
решений). Первое же допустимое решение (опорный план) будет оптимальным.

**Пример**. Решить следующую задачу методом последовательного уточнения
оценок:

  --- ----- ----- ---- -- --- ----- ------ -----
                  1                        1
  =   1     --2   3       =   --1   --1    5
  =   --3   --7   21      =   3     --10   15
  =   --1   1     2       =   --1   1      2
  =   --5   --4   20      =   5     --9    10
  =   --2   --1   0       =   2     --3    --4
  --- ----- ----- ---- -- --- ----- ------ -----

  --- ----- ----- ------ -- --- ------- ------- -------
                  1                             1
  =   --1   --1   5         =   0,3     --0,1   1,5
  =   13    10    --35      =   --1,3   0,1     3,5
  =   --2   --1   7         =   --0,7   --0,1   3,5
  =   14    9     --35      =   2,3     0,9     --3,5
  =   5     3     --19      =   1,1     0,3     --8,5
  --- ----- ----- ------ -- --- ------- ------- -------

+---+--------+-------+--------+--------+
|   |        |       | 1      | Ответ: |
|   |        |       |        |        |
|   |        |       |        | .      |
+---+--------+-------+--------+--------+
| = | 5/9    | --1/9 | 10/9   |        |
+---+--------+-------+--------+--------+
| = | 14/9   | 1/9   | 35/9   |        |
+---+--------+-------+--------+--------+
| = | 4/9    | --1/9 | 28/9   |        |
+---+--------+-------+--------+--------+
| = | --23/9 | 10/9  | 35/9   |        |
+---+--------+-------+--------+--------+
| = | 1/3    | 1/3   | --22/3 |        |
+---+--------+-------+--------+--------+
